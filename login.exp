#!/usr/bin/expect -f

set user [lindex $argv 0]
set pwd [lindex $argv 1]
set pwd [regsub {\(.*} $pwd ""]
spawn sudo htpasswd /etc/squid3/squid_passwd $user
set timeout 2
expect "New password: "
send "$pwd\r"
set timeout 2
expect "Re-type new password: "
send "$pwd\r"
interact